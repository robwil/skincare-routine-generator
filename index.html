<!DOCTYPE html>
<html>
<head>
  <title>Skincare Routine</title>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.7.1/svg.min.js"></script>
  <link rel="stylesheet" href="https://use.typekit.net/mgf6uol.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>

<div class="container-fluid">
    <div class="row">
        <div class="col-6">
                <div style="font-family: orator-std; font-size: 42px;"><span id="namePlace">Lorem</span>'s Skincare Routine</div>
            <div id="drawing"></div>
        </div>
        <div class="col-6 mt-4">
            <form>
                <div class="form-group">
                    <input type="text" class="form-control" id="nameInput" value="Lorem">
                </div>

                <div class="row mt-4">
                    <div class="col">
                        <input type="text" class="form-control" id="morningCategory1" value="Cleanser">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningCategory1" value="Cleanser">
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col">
                        <input type="text" class="form-control" id="morningProduct1" value="Morning Product 1">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningProduct1" value="Evening Product 1">
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col">
                        <input type="text" class="form-control" id="morningCategory2" value="Active">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningCategory2" value="Active">
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col">
                        <input type="text" class="form-control" id="morningProduct2" value="Morning Product 2">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningProduct2" value="Evening Product 2">
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col">
                        <input type="text" class="form-control" id="morningCategory3" value="Essence">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningCategory3" value="Essence">
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col">
                        <input type="text" class="form-control" id="morningProduct3" value="Morning Product 3">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningProduct3" value="Evening Product 3">
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col">
                        <input type="text" class="form-control" id="morningCategory4" value="Moisturizer">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningCategory4" value="Moisturizer">
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col">
                        <input type="text" class="form-control" id="morningProduct4" value="Morning Product 4">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningProduct4" value="Evening Product 4">
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col">
                        <input type="text" class="form-control" id="morningCategory5" value="Sunscreen">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningCategory5" value="Optional">
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col">
                        <input type="text" class="form-control" id="morningProduct5" value="Morning Product 5">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningProduct5" value="Evening Product 5">
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col">
                        <input type="text" class="form-control" id="morningCategory6" value="" placeholder="Optional 6th Step">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningCategory6" value="" placeholder="Optional 6th Step">
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col">
                        <input type="text" class="form-control" id="morningProduct6" value="">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="eveningProduct6" value="">
                    </div>
                </div>

                <h3 class="mt-4">
                    Actives
                </h3>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" checked id="activesEnabled">
                    <label class="form-check-label" for="activesEnabled">
                        Enabled
                    </label>
                </div>
                <div class="row mt-4">
                    <div class="col">
                        <input type="text" class="form-control" id="active1" value="Retin-A">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="active2" value="AHA">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="active3" value="Retin-A">
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col">
                        <input type="text" class="form-control" id="active4" value="BHA">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="active5" value="Retin-A">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" id="active6" value="AHA">
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col">
                        <input type="text" class="form-control" id="active7" value="BHA">
                    </div>
                    <div class="col">
                    </div>
                    <div class="col">
                    </div>
                </div>
            </form>
        </div>
    </div>
</div> <!-- end .container -->

<script type="text/javascript">
    var MAX_STEPS = 6;
    var draw;
    SVG.on(document, 'DOMContentLoaded', function() {
        draw = SVG('drawing');
        regenerateChart();
    });
    var getNumberOfSteps = function() {
        // loop until empty step category found
        for (var i = 1; i <= MAX_STEPS; i++) {
            if (document.getElementById('morningCategory' + i).value === '' && document.getElementById('eveningCategory' + i).value === '') {
                return i-1;
            }
        }
        return MAX_STEPS;
    };
    var regenerateChart = function() {
        draw.clear();

        var numSteps = getNumberOfSteps();
        var activesEnabled = document.getElementById('activesEnabled').checked;
        var halfSize = 300;
        var height = 245 + (numSteps * 100);
        if (!activesEnabled) {
            height -= 150;
        }

        // initialize
        document.getElementById('namePlace').innerHTML = document.getElementById('nameInput').value;
        document.getElementById('drawing').style.height = height + 'px';
        document.getElementById('drawing').style.width = '100%';
        // base shapes
        draw.rect(halfSize, height).radius(10).fill('#f6eeae');
        draw.rect(halfSize, height).radius(10).move(halfSize, 0).fill('#92b0e6');
        // header text and icons
        draw.text('Morning').move(90, 10).font({ fill: '#000', size: 42, family: 'orator-std' });
        draw.text('Evening').move(halfSize + 90, 10).font({ fill: '#000', size: 42, family: 'orator-std' });
        draw.line(100, 68, 252, 68).stroke({ width: 2 });
        draw.line(halfSize + 100, 68, halfSize + 252, 68).stroke({ width: 2 });
        draw.image('sun.png', 61, 62).move(18, 12);
        draw.image('moon.png', 51, 51).move(334, 20);
        
        // setup step circles
        
        var circleXOffset = 260;
        for (var i = 1; i <= numSteps; i++) {
            // TODO: figure out text anchor for centering: https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/text-anchor
            var stepYOffset = 100 * i - 10;
            draw.circle(80).fill('#fff').stroke({ width: 1 }).move(circleXOffset, stepYOffset);
            draw.text(String(i)).move(circleXOffset + 30, stepYOffset + 5).font({ size: 42, family: 'fira-sans' });
            draw.text(document.getElementById('morningCategory' + i).value).move(130, stepYOffset + 15).font({ weight: 'bold', size: 18, family: 'fira-sans', anchor: 'middle' });
            draw.text(document.getElementById('morningProduct' + i).value).move(130, stepYOffset + 40).font({ size: 14, family: 'fira-sans', anchor: 'middle' });
            draw.text(document.getElementById('eveningCategory' + i).value).move(halfSize + 160, stepYOffset + 15).font({ weight: 'bold', size: 18, family: 'fira-sans', anchor: 'middle' });
            draw.text(document.getElementById('eveningProduct' + i).value).move(halfSize + 160, stepYOffset + 40).font({ size: 14, family: 'fira-sans', anchor: 'middle' });
        }

        // active of the day
        if (activesEnabled) {
            var bottomPadding = 20;
            var activesHeight = 130;
            var activesBoxTop = height - activesHeight - bottomPadding;
            var activeSliceWidth = 56;
            var colors = ['#ffa6a6', '#ffd8a6', '#fffaa6', '#aeffa6', '#a6f4ff', '#b8a6ff', '#f8a6ff'];
            var days = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];
            draw.image('lotion.png', 150, 150).move(10, height - 150 - bottomPadding);
            
            for (var i = 0 ; i < 7; i++) {
                draw.rect(activeSliceWidth, activesHeight).move(180 + (i * activeSliceWidth), activesBoxTop).radius(5).fill(colors[i]).stroke({width: 2, color: '#fff'});
                draw.text(days[i]).move(207 + (i * activeSliceWidth), activesBoxTop + 40).font({ size: 18, family: 'fira-sans', anchor: 'middle' });
                draw.text(document.getElementById('active' + (i+1)).value).move(207 + (i * activeSliceWidth), activesBoxTop + 80).font({ size: 14, family: 'fira-sans', anchor: 'middle' });
            }
            draw.rect(250, 20).move(250, activesBoxTop + 10).fill('#fff').radius(10);
            draw.text('Active of the Day').move(280, activesBoxTop + 7).font({ size: 18, family: 'orator-std' });
            draw.rect(activeSliceWidth * 7, activesHeight).move(180, activesBoxTop).radius(5).fill('transparent').stroke({ width: 2 });
        }
    };

    // Event listeners
    var inputs = document.querySelectorAll('input[type=text]');
    for (var i = 0; i < inputs.length; i++) {
        inputs[i].addEventListener('change', function() {
            regenerateChart();
        });
    }
    document.getElementById('activesEnabled').addEventListener('change', function() {
        regenerateChart();
    });

    // TODO: add color pickers like https://bgrins.github.io/spectrum/
    // TODO: mobile support. consider editing with text.on('click', function() {...} ) instead of side form
    
</script>

</body>
</html>
